<p>You need to <a href="/docs/v2/research-environment/machine-learning/popular-libraries/keras#04-Prepare-Data">prepare the historical data</a> for training before you train the model. If you have prepared the data, build and train the model. In this example, build a neural network model that predicts the future return of the SPY. Follow these steps to create the model:<br></p>

<ol>
    <li>Call the <code>Sequential</code> constructor with a list of layers.</li>
    <div class="section-example-container">
        <pre class="python">model = Sequential([Dense(10, input_shape=(5,5), activation='relu'),
                    Dense(10, activation='relu'),
                    Flatten(),
                    Dense(1)])</pre>
    </div>
    <p>Set the <code>input_shape</code> of the first layer to <code>(5, 5)</code> because each sample contains the percent change of 5 factors (percent change of the open, high, low, close, and volume) over the previous 5 days. Call the <code>Flatten</code> constructor because the input is 2-dimensional but the output is just a single value.</p>

    <li>Call the <code>compile</code> method with a loss function, an optimizer, and a list of metrics to monitor.</li>
    <div class="section-example-container">
        <pre class="python">model.compile(loss='mse',
              optimizer=RMSprop(0.001),
              metrics=['mae', 'mse'])</pre>
    </div>

    <li>Call the <code>fit</code> method with the features and labels of the training dataset and a number of epochs.</li>
    <div class="section-example-container">
        <pre class="python">model.fit(X_train, y_train, epochs=5)</pre>
    </div>
</ol>
